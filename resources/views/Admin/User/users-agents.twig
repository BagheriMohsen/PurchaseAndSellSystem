{% extends 'Admin/Master/layout' %}

{% block title %}
  نمایندگان
{% endblock %}

{% block header %}
  {% include 'Admin/Master/header' %}
{% endblock %}

{% block sidebar %}
  {% include 'Admin/Master/sidebar' %}
{% endblock %}

{% block path %}
  {% include 'Admin/Master/path' with {'title':'نمایندگان'} %}
{% endblock %}

{% block content %}
<div >
  <table id="dtDynamicVerticalScrollExample" class="table table-striped table-bordered table-sm" cellspacing="2"
  width="100%">
      <thead>
        <tr>
          <th>نام</th>
          <th>ارسال خودکار</th>
          <th>استان</th>
          <th>نام کاربری</th>
          <th>مدیر نماینده</th>
          <th>تعرفه پیش فرض داخلی</th>
          <th>تعرفه پیش فرض حومه</th>
          <th>تعرفه پیش فرض روستا</th>
          <th>نوع محاسبه مشارکت</th>
          <th>عملیات</th>
        </tr>
      </thead>
      <tbody>
      {% for user in users %}
        <tr>
          <td>{{user.name}}</td>

          {% if user.sendAuto != null %}
              <td class="text-success">{{'فعال'}}</td>
          {% else %}
              <td class="text-danger">{{'غیر فعال'}}</td>
          {% endif %}

          <td>{{user.state.name}}</td>

          <td>{{user.username}}</td>

          {% if user.chief.name != null %}
            <td>{{user.chief.username}}</td>
          {% else %}
            <td class="text-info">{{'ندارد'}}</td>
          {% endif %}

          <td>{{user.internalPrice}}</td>

          <td>{{user.locallyPrice}}</td>

          <td>{{user.villagePrice}}</td>

          {% if user.calType != null %}
            <td>{{'مبلغ فاکتور'}}</td>
          {% else %}
            <td>{{'تعرفه تعیین شده'}}</td>
          {% endif %}
          <td>
            <a href="{{route('users.edit',user.id)}}" >
              <i class="far fa-edit crud-icon text-warning"></i>
            </a> 
            <a href="{{route('users.destroy',user.id)}}" >
              <i class="far fa-trash-alt crud-icon text-danger"></i>
            </a> 
          </td>
        </tr>
      {% endfor %}
      </tbody>

    </table>

</div>




{# special share #}
{% for user in users %}
<!-- The Modal -->
<div class="modal fade " id="types{{user.id}}">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header ">

        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body text-center ">
        <table  class="table table-bordered table-striped bg-white pt-2 pb-2">
          <thead>
          <tr class="text-center">
            <th>محصول</th>
            <th>تعرفه داخلی</th>
            <th>تعرفه حومه</th>
            <th>تعرفه روستا</th>
            <th>عملیات</th>
          </tr>
          </thead>
          <tbody>


            {% for tariff in user.tariffs %}
              <tr class="text-center">
                
                <td>#</td>
                <th>{{tariff.internalPrice}}</th>
                <th>{{tariff.locallyPrice}}</th>
                <th>{{tariff.villagePrice}}</th>
                <td>
                  <a  class="text-warning " href="#">
                    <i class="far fa-edit crud-icon"></i>
                  </a>
                  <form  action="{{route('special-tariffs.destroy',tariff.id)}}" method="post" >
                      <input type="hidden" name="_token" value="{{csrf_token()}}" />
                      <input type="hidden" name="_method" value="DELETE" />
                    <button class="btn btn-default text-danger btn-sm" type="submit" name="button">
                      <i class="far fa-trash-alt crud-icon"></i>
                    </button>
                  </form>
                </td>
              </tr>

        {% endfor %}

          </tbody>

        </table>
        <form action="{{route('special-tariffs.store')}}" method="post">
           <input type="hidden" name="_token" value="{{csrf_token()}}" />
          <div class=" mb-3">
            <div class="form-control bg-white col-sm-5 mx-auto">
              <select style="width:100%" class="users-product" name="product_id">
                {% for product in products %}
                  <option value="{{product.id}}">{{product.name}}</option>
                {% endfor %}

              </select>
            </div>
            <input type="text" class="form-control mt-2 col-sm-5 mx-auto" name="internalPrice" placeholder="تعرفه داخلی" required>
            <input type="text" class="form-control mt-2 col-sm-5 mx-auto" name="locallyPrice" placeholder="تعرفه حومه" required>
            <input type="text" class="form-control mt-2 col-sm-5 mx-auto" name="villagePrice" placeholder="تعرفه روستا" required>
            <input type="hidden" name="user_id" value="{{user.id}}">

              <button type="submit" class="col-sm-4 mx-auto mt-3 btn btn-outline-success">
                  ثبت
              </button>

          </div>
        </form>

      </div>


    </div>
  </div>
</div>

</div>
{% endfor %}
{# special share #}


{% endblock %}

{% block footer %}
  {% include 'Admin/Master/footer' %}
{% endblock %}
